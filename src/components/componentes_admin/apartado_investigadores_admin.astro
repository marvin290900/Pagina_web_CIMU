---
// Aquí puedes manejar la lógica de formulario o props si quieres más adelante
---

<section id="apartadoInvestigadoresAdmin" class="py-8 bg-white text-center text-black">
  <div class="container mx-auto">
  <h2 class="text-2xl font-semibold mb-6 text-center">Agregar Investigador</h2>

  <form class="space-y-5">
    <div>
      <label for="nombre" class="block mb-1 font-medium text-gray-700">Nombre completo</label>
      <input
        type="text"
        id="nombre"
        name="nombre"
        placeholder="Ej: María Pérez"
        required
        class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
    </div>

    <div>
      <label for="email" class="block mb-1 font-medium text-gray-700">Correo electrónico</label>
      <input
        type="email"
        id="email"
        name="email"
        placeholder="ejemplo@correo.com"
        required
        class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
    </div>

    <div>
      <label for="departamento" class="block mb-1 font-medium text-gray-700">Departamento</label>
      <input
        type="text"
        id="departamento"
        name="departamento"
        placeholder="Ej: Ciencias Sociales"
        class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
    </div>

    <div>
      <label for="descripcion" class="block mb-1 font-medium text-gray-700">Descripción / Perfil</label>
      <textarea
        id="descripcion"
        name="descripcion"
        rows="3"
        placeholder="Breve descripción del investigador"
        class="w-full border border-gray-300 rounded-md px-3 py-2 resize-y focus:outline-none focus:ring-2 focus:ring-blue-500"
      ></textarea>
    </div>

    <div>
  <label for="foto" class="block mb-1 font-medium text-gray-700">Foto</label>
  <input
    type="file"
    id="foto"
    name="foto"
    accept="image/*"
    required
    class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
  />
</div>

    <button
      type="submit"
      class="w-full bg-blue-600 text-white py-2 rounded-md font-semibold hover:bg-blue-700 transition"
    >
      Agregar Investigador
    </button>
  </form>

  </div>
</section>


<script type="module">
  import { agregarInvestigador } from '../../lib/investigadores.js'; // Ajusta ruta real
  

  async function guardarInvestigador(event) {
    event.preventDefault();

    const nombre = document.getElementById('nombre').value.trim();
    const correo = document.getElementById('email').value.trim().toLowerCase();
    const cargo = document.getElementById('departamento').value.trim();
    const file = document.getElementById('foto').files[0];

    if (!file) {
      alert("Selecciona una imagen");
      return;
    }

    // Convertir archivo a ArrayBuffer
    const arrayBuffer = await file.arrayBuffer();
    const archivo = {
      name: file.name,
      buffer: arrayBuffer,
      mimetype: file.type
    };

    // Determina categoría (puedes ajustar según el flujo)
    const categoria = cargo.toLowerCase().includes("pasante") ? "pasantes" : "directivo";

    const resultado = await agregarInvestigador({ nombre, correo, cargo, categoria, archivo });

    if (resultado.ok) {
      alert("Investigador guardado correctamente");
      event.target.reset();
    } else {
      alert("Error al guardar: " + (resultado.error?.message || resultado.error));
    }
  }
</script>
