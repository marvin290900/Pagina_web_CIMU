---
const {
  InvestigadoresDirectivos,
  InvestigadoresPasantes,
  InvestigadoresExternos,
  imagenDefault,
} = Astro.props;
---

<section id="seccionInvestigadores" class="bg-white text-center mt-5 mb-10">
  <div class="container mx-auto px-4">
    <div
      id="cuarto_texto_centro_investigacion"
      class="p-6 flex flex-col justify-center items-center text-center rounded-lg shadow-none transition-all duration-1000 opacity-0 translate-y-8"
    >
      <p
        class="text-2xl sm:text-xl md:text-2xl lg:text-4xl font-bold text-gray-800"
      >
        Conoce a nuestro equipo de Investigación del CIMU - FMOcc - UES
      </p>
    </div>

    <div class="mt-10 flex flex-col lg:flex-row gap-8">
      <!-- Cards de investigadores -->
      <div
        class="flex-1 grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6"
      >
        <!-- Directivos -->
        {
          InvestigadoresDirectivos.length > 0 && (
            <>
              <h3 class="text-lg font-semibold text-gray-800 col-span-full">
                Equipo Directivo del Centro de Investigación
              </h3>
              {InvestigadoresDirectivos.map((inv) => (
                <div
                  class="border rounded-2xl border-gray-300 hover:shadow-xl w-full"
                  key={inv._id}
                >
                  <a
                    href={`/investigadores/${encodeURIComponent(inv._id)}`}
                    class="flex flex-row items-center justify-start h-[140px] border-2 border-transparent rounded-2xl shadow-lg cursor-pointer bg-white p-4 gap-4"
                  >
                    <div class="relative w-28 h-28 flex items-center justify-center">
                      <div class="w-28 h-28 rounded-full overflow-hidden bg-white z-10">
                        <img
                          src={
                            inv.foto && inv.foto.trim() !== ""
                              ? inv.foto
                              : imagenDefault.src
                          }
                          class="w-full h-full object-cover"
                          alt={`Foto de ${inv.nombre}`}
                        />
                      </div>
                    </div>
                    <div class="text-left text-gray-800 flex-1">
                      <p class="text-md font-semibold">{inv.nombre}</p>
                      <p class="text-sm">{inv.cargo}</p>
                      <p class="text-sm text-gray-400">{inv.correo}</p>
                    </div>
                  </a>
                </div>
              ))}
            </>
          )
        }

        <!-- Pasantes -->
        {
          InvestigadoresPasantes.length > 0 && (
            <>
              <h3 class="text-lg font-semibold text-gray-800 col-span-full">
                Equipo Investigador y de Apoyo del CIMU
              </h3>
              {InvestigadoresPasantes.map((inv) => (
                <div
                  class="border rounded-2xl border-gray-300 hover:shadow-xl w-full"
                  key={inv._id}
                >
                  <a
                    href={`/investigadores/${encodeURIComponent(inv._id)}`}
                    class="flex flex-row items-center justify-start h-[140px] border-2 border-transparent rounded-2xl shadow-lg cursor-pointer bg-white p-4 gap-4"
                  >
                    <div class="relative w-28 h-28 flex items-center justify-center">
                      <div class="w-28 h-28 rounded-full overflow-hidden bg-white z-10">
                        <img
                          src={
                            inv.foto && inv.foto.trim() !== ""
                              ? inv.foto
                              : imagenDefault.src
                          }
                          class="w-full h-full object-cover"
                          alt={`Foto de ${inv.nombre}`}
                        />
                      </div>
                    </div>
                    <div class="text-left text-gray-800 flex-1">
                      <p class="text-md font-semibold">{inv.nombre}</p>
                      <p class="text-sm">{inv.cargo}</p>
                      <p class="text-sm text-gray-400">{inv.correo}</p>
                    </div>
                  </a>
                </div>
              ))}
            </>
          )
        }

        <!-- Externos -->
        {
          InvestigadoresExternos.length > 0 && (
            <>
              <h3 class="text-lg font-semibold text-gray-800 col-span-full">
                Equipo Externo del CIMU
              </h3>
              {InvestigadoresExternos.map((inv) => (
                <div
                  class="border rounded-2xl border-gray-300 hover:shadow-xl w-full"
                  key={inv._id}
                >
                  <a
                    href={`/investigadores/${encodeURIComponent(inv._id)}`}
                    class="flex flex-row items-center justify-start h-[140px] border-2 border-transparent rounded-2xl shadow-lg cursor-pointer bg-white p-4 gap-4"
                  >
                    <div class="relative w-28 h-28 flex items-center justify-center">
                      <div class="w-28 h-28 rounded-full overflow-hidden bg-white z-10">
                        <img
                          src={
                            inv.foto && inv.foto.trim() !== ""
                              ? inv.foto
                              : imagenDefault.src
                          }
                          class="w-full h-full object-cover"
                          alt={`Foto de ${inv.nombre}`}
                        />
                      </div>
                    </div>
                    <div class="text-left text-gray-800 flex-1">
                      <p class="text-md font-semibold">{inv.nombre}</p>
                      <p class="text-sm">{inv.cargo}</p>
                      <p class="text-sm text-gray-400">{inv.correo}</p>
                    </div>
                  </a>
                </div>
              ))}
            </>
          )
        }
      </div>

      <!-- Lista única combinada -->
      <div class="mt-8 lg:ml-25 lg:mt-0 lg:w-1/3 text-left">
        <h2
          class="text-xl text-center md:text-2xl font-semibold text-gray-800 mb-4"
        >
          Lista de Investigadores/as
        </h2>
        <ul class="space-y-5 text-center">
          {
            [
              ...InvestigadoresDirectivos,
              ...InvestigadoresPasantes,
              ...InvestigadoresExternos,
            ].map((inv) => (
              <li key={inv._id}>
                <a
                  href={`/investigadores/${encodeURIComponent(inv._id)}`}
                  class="text-blue-900 text-lg lg:text-xl font-semibold hover:underline"
                >
                  {inv.nombre}
                </a>
              </li>
            ))
          }
        </ul>
      </div>
    </div>
  </div>
</section>

<script>
  const ids = [
    "#cuarto_texto_centro_investigacion",
    "#quinto_texto_centro_investigacion",
    "#sexto_texto_centro_investigacion",
    "#titulo_directivos",
    "#titulo_pasantes",
    "#titulo_externos",
    "#septimo_texto_centro_investigacion",
  ];

  const targets = ids
    .map((id) => document.querySelector(id))
    .filter((el) => el !== null); // Solo los que existen

  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.remove("opacity-0", "translate-y-8");
          entry.target.classList.add("opacity-100", "translate-y-0");
        }
      });
    },
    {
      threshold: 0.1,
    }
  );

  targets.forEach((target) => observer.observe(target));
</script>

<style>
  @keyframes girarBorde {
    0% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
    100% {
      background-position: 0% 50%;
    }
  }

  .borde-giratorio {
    position: relative;
    border-radius: 1rem; /* mismo que rounded-2xl */
    padding: 2px; /* espacio para el borde animado */
    background: linear-gradient(270deg, #ffffff, #283886, #ffffff, #283886);
    background-size: 400% 400%;
    animation: girarBorde 8s linear infinite;
  }

  .borde-giratorio > .contenido {
    background: white; /* o transparente si quieres */
    border-radius: 1rem;
    height: 100%;
    width: 100%;
  }

  .borde-giratorio-azul {
    position: relative;
    border-radius: 1rem;
    padding: 2px;
    background: linear-gradient(270deg, #ffffff, #283886, #ffffff, #283886);
    background-size: 400% 400%;
    animation: girarBorde 8s linear infinite;
  }

  .borde-giratorio-verde {
    position: relative;
    border-radius: 1rem;
    padding: 2px;
    background: linear-gradient(270deg, #ffffff, #2e8b57, #ffffff, #2e8b57);
    background-size: 400% 400%;
    animation: girarBorde 8s linear infinite;
  }

  .borde-giratorio-rojo {
    position: relative;
    border-radius: 1rem;
    padding: 2px;
    background: linear-gradient(270deg, #ffffff, #c62828, #ffffff, #c62828);
    background-size: 400% 400%;
    animation: girarBorde 8s linear infinite;
  }
</style>
