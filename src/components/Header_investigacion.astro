---
const { cimuLogo, uesLogoBlanco, uesLogoRojo } = Astro.props;
---

<!-- Se muestra cuando esta en laptop y tablet -->
<header
  id="mainHeader"
  class="navbar fixed top-0 left-0 w-full z-50 transition-colors duration-300 shadow-none"
>
  <div class="flex items-center gap-10 flex-1 ml-4 md:ml-5">
    <a href="/"
      ><img
        id="uesLogo"
        title="Universidad de El Salvador"
        src={uesLogoRojo.src}
        alt="uesLogo"
        data-logo-blanco={uesLogoRojo.src}
        data-logo-rojo={uesLogoRojo.src}
        class="h-8 sm:h-8 md:h-10 lg:h-12 transition-all duration-300 hover:scale-105 hover:brightness-110"
      /></a
    >
    <a href="/"
      ><img
        src={cimuLogo.src}
        alt="cimuLogo"
        title="Centro de Investigación Multidisciplinario FMOcc UES"
        class="h-8 sm:h-8 md:h-10 lg:h-12 transition-all duration-300 hover:scale-105 hover:brightness-110"
      /></a
    >
  </div>

  <!-- Menú para pantallas grandes -->
  <div class="flex-none hidden sm:block mr-10 md:mr-5">
    <ul class="menu menu-horizontal px-1" id="menuPrincipal">
      <li><a href="/">Inicio</a></li>
      <li class="group relative">
        <a class="">Nosotros </a>
        <ul
          class="absolute left-0 top-full bg-white text-black rounded-md opacity-0 group-hover:opacity-100 pointer-events-none group-hover:pointer-events-auto transition duration-300 p-2 shadow-md z-50"
        >
        <li>
            <a
              href="/nosotros/acerca_de_cimu"
              class="block px-4 py-2 rounded-md hover:bg-gray-200 hover:text-black transition duration-200"
              >Acerca de CIMU</a
            >
          </li>
          
          <li>
            <a
              href="/nosotros/investigadores"
              class="block px-4 py-2 rounded-md hover:bg-gray-200 hover:text-black transition duration-200"
              >Investigadores/as</a
            >
          </li>
        </ul>
      </li>

      <li> <a href="/gaceta_multidisciplinaria" class="block max-w-[90px] truncate lg:max-w-none lg:whitespace-normal lg:overflow-visible lg:text-ellipsis-none">Gaceta Multidisciplinaria</a></li>

      <li class="group relative">
        <a class="">Investigaciones </a>
        <ul
          class="absolute left-0 top-full bg-white text-black rounded-md opacity-0 group-hover:opacity-100 pointer-events-none group-hover:pointer-events-auto transition duration-300 p-2 shadow-md z-50"
        >
          
          <li>
            <a
              href="/investigaciones/programa_de_investigaciones"
              class="block px-4 py-2 rounded-md hover:bg-gray-200 hover:text-black transition duration-200"
              >Programas de Investigación</a
            >
          </li>
        </ul>
      </li>

      <li class="group relative">
        <a class="">Publicaciones</a>
        <ul
          class="absolute left-0 top-full bg-white text-black rounded-md opacity-0 group-hover:opacity-100 pointer-events-none group-hover:pointer-events-auto transition duration-300 p-2 shadow-md z-50"
        >
          <li>
            <a
              href="/publicaciones/multidisciplinaria/multidisciplinaria_editorial"
              class="block px-4 py-2 rounded-md hover:bg-gray-200 hover:text-black transition duration-200"
              >Multidisciplinaria Editorial</a
            >
          </li>
          <li>
            <a
              href="/publicaciones/remi"
              class="block px-4 py-2 rounded-md hover:bg-gray-200 hover:text-black transition duration-200"
              >REMI</a
            >
          </li>
        </ul>
      </li>

      <li><a href="/contactenos">Contáctenos</a></li>
    </ul>
  </div>

  <!-- Menú para móvil -->
  <div class="flex-none sm:hidden relative">
    <!-- Botón hamburguesa -->
    <button id="toggleMenu" class="btn btn-square btn-ghost">
      <span class="mdi mdi-menu text-2xl"></span>
    </button>
  </div>

  <!-- Menú desplegable pegado a la izquierda -->
  <div
    id="mobileMenu"
    class="fixed left-0 right-0 top-16 bg-white text-black rounded-md shadow-lg p-4 z-50 hidden animate-fade-in w-full max-w-md mx-auto"
  >
    <a href="/" class="block py-2 px-3 rounded-md hover:bg-gray-100">Inicio</a>
    <details>
      <summary class="cursor-pointer py-2 px-3 hover:bg-gray-100 rounded-md"
        >Nosotros</summary
      >
      <ul class="pl-4 mt-2">
        <li>
          <a
            href="/nosotros/acerca_de_cimu"
            class="block px-4 py-2 rounded-md hover:bg-gray-200 hover:text-black transition duration-200"
            >Acerca de CIMU</a
          >
        </li>
        <li>
          <a
            href="/nosotros/investigadores"
            class="block px-4 py-2 rounded-md hover:bg-gray-200 hover:text-black transition duration-200"
            >Investigadores/as</a
          >
        </li>
      </ul>
    </details>


    <a href="/gaceta_multidisciplinaria" class="block py-2 px-3 rounded-md hover:bg-gray-100">Gaceta Multidisciplinaria</a>

    <details>
      <summary class="cursor-pointer py-2 px-3 hover:bg-gray-100 rounded-md"
        >Investigaciones</summary
      >
      <ul class="pl-4 mt-2">
        
        <li>
          <a
            href="/investigaciones/programa_de_investigaciones"
            class="block px-4 py-2 rounded-md hover:bg-gray-200 hover:text-black transition duration-200"
            >Programas de Investigación</a
          >
        </li>
      </ul>
    </details>

    <details>
      <summary class="cursor-pointer py-2 px-3 hover:bg-gray-100 rounded-md"
        >Publicaciones</summary
      >
      <ul class="pl-4 mt-2">
        <li>
          <a
            href="/publicaciones/multidisciplinaria/multidisciplinaria_editorial"
            class="block px-4 py-2 rounded-md hover:bg-gray-200 hover:text-black transition duration-200"
            >Multidisciplinaria Editorial</a
          >
        </li>
        <li>
          <a
            href="/publicaciones/remi"
            class="block px-4 py-2 rounded-md hover:bg-gray-200 hover:text-black transition duration-200"
            >REMI</a
          >
        </li>
      </ul>
    </details>

    <a href="/contactenos" class="block py-2 px-3 rounded-md hover:bg-gray-100"
      >Contáctenos</a
    >
  </div>
</header>

<script is:inline>
  const logo = document.getElementById("uesLogo");
  const uesLogoBlanco = logo.dataset.logoBlanco;
  const uesLogoRojo = logo.dataset.logoRojo;

  // Cambiar color y logo al hacer scroll
  window.addEventListener("scroll", () => {
    const header = document.getElementById("mainHeader");
    const logo = document.getElementById("uesLogo");
    if (!header || !logo) return;

    if (window.scrollY > 50) {
      header.classList.add("bg-white", "text-black", "shadow-md");
      header.classList.remove("bg-transparent", "text-white");
      logo.src = uesLogoRojo;
    } else {
      header.classList.add("bg-transparent");
      header.classList.remove("bg-white", "text-black", "shadow-md");
      logo.src = uesLogoRojo;
    }
  });

  // Cierra todos los submenús cuando se hace clic en un enlace
  document.querySelectorAll("#menuPrincipal a").forEach((link) => {
    link.addEventListener("click", () => {
      document.querySelectorAll("#menuPrincipal li ul").forEach((submenu) => {
        submenu.classList.remove("opacity-100", "pointer-events-auto");
        submenu.classList.add("opacity-0", "pointer-events-none");
      });
    });
  });

  // Cierra submenús al cambiar de página
  window.addEventListener("beforeunload", () => {
    document.querySelectorAll("#menuPrincipal li ul").forEach((submenu) => {
      submenu.classList.remove("opacity-100", "pointer-events-auto");
      submenu.classList.add("opacity-0", "pointer-events-none");
    });
  });

  const toggleBtn = document.getElementById("toggleMenu");
  const mobileMenu = document.getElementById("mobileMenu");

  toggleBtn.addEventListener("click", () => {
    mobileMenu.classList.toggle("hidden");
  });

  // Cerrar al hacer clic fuera del menú
  document.addEventListener("click", (event) => {
    const isClickInsideMenu = mobileMenu.contains(event.target);
    const isClickOnButton = toggleBtn.contains(event.target);

    if (!isClickInsideMenu && !isClickOnButton) {
      mobileMenu.classList.add("hidden");
    }
  });

  // Cierra al hacer clic en cualquier enlace del menú móvil
  mobileMenu.querySelectorAll("a").forEach((link) => {
    link.addEventListener("click", () => {
      mobileMenu.classList.add("hidden");
    });
  });
</script>
